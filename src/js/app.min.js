"use strict";function getParams(){for(var t={},e=window.location.search.substring(1).split("&"),a=0;a<e.length;a++){var n=e[a].split("=");t[n[0]]=void 0===n[1]?"":n[1]}return t}function d(t){$(".debug").html(t)}function getRandomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}function getRandomRgbColor(){return"rgb("+getRandomInt(0,255)+","+getRandomInt(0,255)+","+getRandomInt(0,255)+")"}function getHash(t){for(var e="",a=0;a<t;a++)e+=String.fromCharCode(getRandomInt(33,127));return e}var dateStart=(new Date).getTime();$.ajaxSetup({type:"POST",url:"actions.php",complete:function(){},statusCode:{200:function(t){},403:function(t){var e=JSON.parse(t.responseText);$("body").prepend(e.message)}},error:function(t,e,a,n){console.log("XHR error")}}),void 0!==getParams().admin?$("body").addClass("admin"):$("body").removeClass("admin"),$(document).ready(function(){function t(){var t,e,a,n=m().title,o=n.length,i=$("#player .info .trackTitle"),s=250;$("title").html("RadioRA::"+n),i.html(n).removeClass("runningString").parent().css({width:"auto"}),e=i.width(),a=e/o,t=Math.floor(s/a)-5,e>240?window.innerWidth>700?i.addClass("runningString").parent().css({width:"240px"}):i.html(n.substr(0,t)+"..."):i.removeClass("runningString").parent().css({width:"auto"})}function e(t){$.ajax({data:{action:"getStation",id:t},success:function(t){for(var e=JSON.parse(t),a=S.find('.playlist[data-name="'+k.currentPlaylist+'"]'),n="",o=0;o<e.length;o++){var i=e[o];n+='<div class="track" data-station-id="'+i.station_id+'" data-station-title="'+i.station_title+'" data-station-url="'+i.station_url+'"><div class="delete"><i class="fa fa-minus"></i></div><div class="title">'+i.station_title+'</div><div class="url">'+i.station_url+"</div></div>",k.playlists[k.currentPlaylist].tracks.push(+i.station_id),k.playlists[k.currentPlaylist].currentTrack={id:i.station_id,url:i.station_url,title:i.station_title}}localStorage.setItem("playerState",JSON.stringify(k)),a.html(a.html()+n)}})}function a(t){this.name=t,this.tracks=[],this.currentTrack={},this.htmlEl='<div class="playlist active sortable" data-name="'+this.name+'">',k.playlists[t]=this,k.playlistsOrder.push(this.name)}function n(t,e,a){var n=this,o=t.createAnalyser();o.smoothingTimeConstant=a.smoothingTimeConstant||.7,o.fftSize=a.fftSize||512,e.connect(o),o.connect(I.destination);var i=function(){o.getByteFrequencyData(n.streamData);for(var t=0,e=0;e<80;e++)t+=n.streamData[e]};setInterval(i,20),n.streamData=new Uint8Array(o.frequencyBinCount)}function o(t){var e=document.getElementById(t),a=this,o=I.createMediaElementSource(e),i=new n(I,o,{smoothingTimeConstant:.5,fftSize:1024}),l=new n(I,o,{smoothingTimeConstant:.5,fftSize:1024}),u=new n(I,o,{smoothingTimeConstant:.5,fftSize:64}),g=new n(I,o,{smoothingTimeConstant:.5,fftSize:512});this.streamData_1=i.streamData,this.streamData_2=l.streamData,this.streamData_3=u.streamData,this.streamData_4=g.streamData,s(e,"AudioApiElement"),this.playStream=function(t){console.log("AudioApiElement::playStream::Begin"),console.log(t);var n=$('.playlistContainer .active [data-station-url="'+t+'"]'),o={url:n.attr("data-station-url"),title:n.attr("data-station-title"),id:n.attr("data-station-id")};k.playlists[k.currentPlaylist].currentTrack=o,k.playlists[k.currentPlaylist].currentTrack.scrollPosition=n.position().top,e.src=t,e.crossOrigin="anonymous",setTimeout(function(){e.crossOrigin="anonymous"},3e3);var i=e.play();$(".spinner").show(),void 0!==i&&i.then(function(){console.log("AudioApiElement::playPromise::Success::Begin"),console.log("AudioApiElement::playPromise::Success::End")}).catch(function(n){console.log("AudioApiElement::playPromise::Failed::Begin"),console.log(e.paused),a.stopStream(),x.playStream(t),console.log("Start audioCbElement"),console.log("AudioApiElement::playPromise::Failed::End")}),k.paused=e.paused,localStorage.setItem("playerState",JSON.stringify(k)),r(),c(),d(),console.log("AudioApiElement::playStream::End")},this.stopStream=function(){p(),$("#player .play").removeClass("visualisation"),$("#player .info .trackTitle").html("").removeClass("runningString").parent().css({width:"auto"}),e.pause(),x.stopStream(),e.currentTime=0,k.paused=e.paused,console.log("AudioApiElement::stopStream"),localStorage.setItem("playerState",JSON.stringify(k))},this.setVolume=function(t){e.volume=t},this.getVolume=function(){return e.volume}}function i(){var t=new Audio;s(t,"AudioCbElement"),this.playStream=function(e){console.log("AudioCbElement::playStream::Begin"),t.src=e,t.play(),$(".spinner").show(),console.log(t.paused),k.paused=t.paused,localStorage.setItem("playerState",JSON.stringify(k)),console.log("AudioCbElement::playStream::End")},this.stopStream=function(){p(),$("#player .play").removeClass("visualisation"),$("#player .info .trackTitle").html("").removeClass("runningString").parent().css({width:"auto"}),t.pause(),t.currentTime=0,k.paused=t.paused,console.log("AudioCbElement::stopStream"),localStorage.setItem("playerState",JSON.stringify(k))},this.setVolume=function(e){t.volume=e},this.getVolume=function(){return t.volume}}function s(e,a){e.addEventListener("abort",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("canplay",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("canplaythrough",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("durationchange",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("emptied",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("encrypted",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("ended",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("error",function(t){console.log(a+"::Event.type::"+t.type),$(".spinner").hide()}),e.addEventListener("interruptbegin",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("interruptend",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("loadeddata",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("loadedmetadata",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("loadstart",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("mozaudioavailable",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("pause",function(t){console.log(a+"::Event.type::"+t.type),p()}),e.addEventListener("play",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("playing",function(e){console.log(a+"::Event.type::"+e.type),$(".spinner").hide(),u(),t()}),e.addEventListener("ratechange",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("seeked",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("seeking",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("timeupdate",function(t){var a=Math.ceil(e.currentTime),n=("0"+parseInt(Math.floor(a%60))).slice(-2),o=("0"+parseInt(Math.floor(a/60)%60)).slice(-2);$("#player .time .hours").html(),$("#player .time .minutes").html(o),$("#player .time .seconds").html(n)}),e.addEventListener("stalled",function(t){console.log(a+"::Event.type::"+t.type),$(".spinner").hide()}),e.addEventListener("suspend",function(t){console.log(a+"::Event.type::"+t.type)}),e.addEventListener("waiting",function(t){console.log(a+"::Event.type::"+t.type)})}function l(t,e,a){var n=document.getElementById(t);n.width=e,n.height=a,this.ctx=n.getContext("2d"),this.canvasWidth=n.width,this.canvasHeight=n.height}function r(){var t=new l("canvas-audio-source",500,510);for(t.ctx.clearRect(0,0,t.canvasWidth,t.canvasHeight),bin=0;bin<O.streamData_1.length;bin++){var e=O.streamData_1[bin];t.ctx.fillStyle="rgb("+e+","+e+","+e+")",t.ctx.fillRect(bin,t.canvasHeight/2+1,1,Math.floor(-e/1.5)),t.ctx.fillRect(bin,t.canvasHeight/2-1,1,Math.floor(e/1.5))}requestAnimationFrame(r)}function c(){var t=new l("canvas-audio-source-eq2",500,510);for(t.ctx.clearRect(0,0,t.canvasWidth,t.canvasHeight),bin=0,size=O.streamData_2.length;bin<size;bin++){var e=O.streamData_2[bin];t.ctx.fillStyle="rgb("+(255-e)+","+e+","+(255-e)+")",t.ctx.fillRect(size-bin,t.canvasHeight/2+1,1,-e/1.5),t.ctx.fillRect(size-bin,t.canvasHeight/2-1,1,e/1.5)}requestAnimationFrame(c)}function d(){var t=new l("canvas-audio-source-eq3",288,20);t.ctx.clearRect(0,0,t.canvasWidth,t.canvasHeight);for(var e=Math.floor(25.5),a=Math.floor(t.canvasWidth/32),n=Math.floor(t.canvasHeight/e),o=3,i=a+o,s=n+o,r=0;r<O.streamData_3.length;r++)for(var c=O.streamData_3[r],u=Math.floor(c/10),p=0;p<u;p++)t.ctx.strokeStyle="hsl("+(180-7*p)+", 100%, 50%)",t.ctx.strokeRect(r*i,t.canvasHeight-p*s,a,n);requestAnimationFrame(d)}function u(){console.log("visualisation::Begin"),p();var t=$('.playlistContainer .active [data-station-id="'+m().id+'"]');t.addClass("visualisation"),$("#player .play").addClass("visualisation"),$("#player .play span").remove(),$("#player .play.visualisation").prepend('<span class="inner"></span><span class="outer"></span>');var e=Math.floor(360*Math.random()),a=e+180,n=Math.floor(360*Math.random());window.innerWidth>700&&(L=setInterval(function(){t.css({backgroundImage:"linear-gradient(to right, hsl("+ ++e%360+", 60%, 50%) 0%, hsl("+ ++a%360+", 60%, 50%) 100%)"}),$("#player .play.visualisation").css({boxShadow:"0px 0px 5px 0.4px hsl("+ ++n%360+", 100%, 50%)",borderColor:"hsl("+ ++n%360+", 100%, 50%)"}),$("#player .play.visualisation .inner").css({borderBottomColor:"hsl("+ ++n%360+", 100%, 50%)"}),$("#player .play.visualisation .outer").css({borderTopColor:"hsl("+ ++n%360+", 100%, 50%)"})},50)),console.log("visualisation::End")}function p(){console.log("visualisationStop::Begin"),clearInterval(L),$('.playlistContainer .active [data-station-id="'+m().id+'"]').removeClass("visualisation").css({backgroundImage:"none"}).removeAttr("style"),$("#player .play").removeClass("visualisation").css({boxShadow:"none",borderColor:"#0ff"}).removeAttr("style"),$("#player .play span").remove(),console.log("visualisationStop::End")}function g(){var t=Math.ceil(+$("#player .volume input").val()/10);P.clearRect(0,0,_,q);for(var e=36*t,a=0,n=3,o=1,i=Math.floor(_/(o+n)),s=Math.floor(i/10*t),l=q,r=l/i,c=0;c<s;c++)P.fillStyle="hsl("+c*e/s+", 100%, 50%)",P.fillRect(c*(o+n),q-c*r-r,n,c*r+r),P.fill();a+=15}function v(t){setTimeout(function(){$(".searchContainer .close").animate({top:-(t.mcs.top-10)+"px"},150)},50)}function m(){return k.playlists[k.currentPlaylist].currentTrack}function h(t){var e,a=m(),n=$('.playlistContainer .active [data-station-id="'+a.id+'"]');if("prev"===t)e=n.prev();else{if("next"!==t)throw new Error("Не передано направление!");e=n.next()}if(e.length)return e.attr("data-station-url");console.log("no siblings")}function f(){console.log("::makeDebugButton");var t=$(".resetLocalStorage"),e=t.find(".resetItem"),a=t.find(".resetItemList"),n=[],o="";e.attr("disabled","disabled"),n.push({item:"playerState",prop:"search.stationsOpened",name:"StationsOpened"}),n.push({item:"playerState",prop:"volume",name:"Volume"});for(var i=0;i<n.length;i++)o+='<li class="remove" data-change-item="'+n[i].item+'" data-change-prop="'+n[i].prop+'"><a href="#">'+n[i].name+"</a></li>";a.html(o),$("[data-change-prop]").on("click",function(t){var a=$(this).attr("data-change-item");prop=$(this).attr("data-change-prop"),e.attr("data-remove-item",a),e.attr("data-remove-prop",prop),e.removeAttr("disabled"),$("[data-remove-prop]").on("click",function(t){var e=$(this).attr("data-remove-item"),a=$(this).attr("data-remove-prop");$(".resetItem");switch(e){case"playerState":delete k[a],console.log("delete "+a)}return localStorage.setItem("playerState",JSON.stringify(k)),!1})})}if($("body").attr("data-useragent",navigator.userAgent),$("body").css({background:'url("../img/bg/bg'+getRandomInt(1,10)+'.jpg") no-repeat center / cover'}),$(function(){for(var t=new Array(10),e=0;e<t.length;e++){var a="/img/bg/bg"+(e+1)+".jpg";t[e]=a}$.mbBgndGallery.buildGallery({containment:"body",timer:3e3,effTimer:11e3,shuffle:!0,effect:"fade",images:t,onChange:function(t){}})}),$(".searchContainer").mCustomScrollbar({callbacks:{onScroll:function(){v(this)}}}),$("#player .prev").click(function(t){console.log("prev");var e=h("prev");console.log(e),e&&(O.stopStream(),O.playStream(e))}),$("#player .next").click(function(t){console.log("next");var e=h("next");console.log(e),e&&(O.stopStream(),O.playStream(e))}),$("#player .play").on("click",function(t){k.paused&&(O.playStream(m().url),$(".playlistContainer").mCustomScrollbar("scrollTo",m().scrollPosition))}),$(".playlistContainer").on("click",".track",function(t){if(k.paused){$(this).attr("data-current-track",1);var e=$(this).data("stationUrl");O.playStream(e)}else if($(this).attr("data-current-track"))$(this).removeAttr("data-current-track"),O.stopStream();else{$(this).attr("data-current-track",1);var e=$(this).data("stationUrl");O.stopStream(),O.playStream(e)}}),$("#player .stop").click(function(t){O.stopStream()}),$(".playlistContainer").on("click",".delete",function(t){var e=$(this).parent().data("stationId"),a=k.playlists[k.currentPlaylist];a.tracks.splice(a.tracks.indexOf(e),1),$(this).parent().remove(),localStorage.setItem("playerState",JSON.stringify(k))}),$(".playlistContainer").on("click",".canplaytest",function(t){var e=$(t.target).closest(".track").data("stationUrl");console.log(e),t.stopPropagation()}),$(".clearLocalStorage").on("click",function(t){return localStorage.clear(),!1}),$(".clearUniqHash").on("click",function(t){return localStorage.removeItem("stations"),!1}),$(".toAdmin").on("click",function(t){return console.log("toAdmin"),$("body").addClass("admin"),$.ajax({data:{admin:1},success:function(t){$("#player").after(t),$("#player").hide(),$(".toPlayer").on("click",function(t){return console.log("toPlayer"),$(".admin-wrapper").remove(),$("body").removeClass("admin"),$("#player").fadeIn(300),!1})}}),!1}),$("#player .volume input").on("input",function(t){var e=$(this);O.setVolume(parseFloat($(this).val()/100)),x.setVolume(parseFloat($(this).val()/100)),k.volume=O.getVolume(),k.volume=x.getVolume(),$("#player .volume .val").html($(this).val()),0!=+e.val()?g(Math.ceil(+e.val()/10)):P.clearRect(0,0,_,q),localStorage.setItem("playerState",JSON.stringify(k))}),$("#player .volume").on("wheel",function(t){t=t||window.event;var e=$(this).find("input"),a=t.originalEvent.deltaY||t.originalEvent.detail||t.originalEvent.wheelDelta;return a>0&&+e.val()>0?e.val(+e.val()-2).trigger("input"):a<0&&+e.val()<100&&e.val(+e.val()+2).trigger("input"),!1}),$("#player .volume").on("click",function(t){return t=t||window.event,$(this).find("input").val(t.offsetX).trigger("input"),!1}),$("#player .find .showFieldSearch").click(function(t){$(this).toggleClass("active");var e=$(this).parent().find("input");0==e.hasClass("visible")?(e.addClass("visible").animate({opacity:1,width:190},100),setTimeout(function(){e.focus()},300)):e.removeClass("visible").animate({opacity:0,width:0},100).blur()}),$("#player .find input").on("keyup",function(t){var e=$(this).val();e.length>2&&($(".spinner").show(),$.ajax({data:{action:"search",target:e},success:function(t){var e=JSON.parse(t),a=$(".searchContainer .result"),n='<div class="total"><span>'+e.length+"</span> stations is found</div>";a.html("");for(var o=0;o<e.length;o++){var i=e[o];n+='<div class="station" data-station-id="'+i.station_id+'"><div class="add"><i class="fa fa-plus"></i></div><div class="title">'+i.station_title+'</div><div class="url">'+i.station_url+"</div></div>"}a.html(n),$(".spinner").hide(),$(".searchContainer").removeClass("searchContainerFadeOut").addClass("searchContainerFadeIn visible").parent().removeClass("playerLeft").addClass("playerRight"),window.innerHeight<=640&&window.innerWidth<700&&$(".playlistContainer").toggleClass("hidden")}}))}),$("#player .find .showAll").on("click",function(t){if($(this).toggleClass("active"),!$(".searchContainer .result .station").length){$(".spinner").show();var e=E,a=e.length,n=$(".searchContainer .result"),o=100,i=Math.ceil(a/o),s='<div class="total"><span>'+a+"</span> stations is found</div>";console.log(a),console.log(i),n.html("");for(var l=0;l<i;l++){var r=100*l,c=100*(l+1);l==i-1&&(c=(i-1).toString()+a%100),s+='<div class="stationsBlockToggle" data-show="closed" data-block-number="'+l+'"><div class="title">'+r+".."+c+"</div></div>"}n.html(s),$(".stationsBlockToggle").on("click",function(t){var e=k.search.stationsOpened,a="",n=$(this).attr("data-block-number");if("closed"==$(this).attr("data-show")){var o=A[n];a+='<div class="stationsBlockList" data-stations-number='+n+">";for(var i=0;i<o.length;i++){var s=o[i];a+='<div class="station" data-station-id="'+s.station_id+'"><div class="add"><i class="fa fa-plus"></i></div><div class="title">'+s.station_title+'</div><div class="url">'+s.station_url+"</div></div>"}return a+="</div>",$(this).after(a),$(this).attr("data-show","open"),console.log(e),e.push(n),console.log(e),e.length>3&&(console.log("лишний "+e[0]),$('[data-stations-number="'+e[0]+'"]').remove(),$('[data-stations-number="'+e[0]+'"]').attr("data-show","closed"),console.log(e),e.shift(),console.log(e)),console.log("stationsBlockToggle №"+n+" opened"),console.log(e),!1}return e=e.filter(function(t){return console.log("filter"),t!=n}),console.log(e),$(this).next("[data-stations-number]").remove(),$(this).attr("data-show","closed"),console.log("stationsBlockToggle №"+n+" removed"),!1}),$(".spinner").hide();var d=(new Date).getTime();console.log(d-dateStart+"ms")}$(".spinner").show(),$(".searchContainer").hasClass("visible")?$(".searchContainer").removeClass("searchContainerFadeIn visible").addClass("searchContainerFadeOut").parent().removeClass("playerRight").addClass("playerLeft"):$(".searchContainer").removeClass("searchContainerFadeOut").addClass("searchContainerFadeIn visible").parent().removeClass("playerLeft").addClass("playerRight"),window.innerHeight<=640&&window.innerWidth<700&&$(".playlistContainer").toggleClass("hidden"),$(".spinner").hide()}),$(".searchContainer .close").on("click",function(t){$(".showAll").removeClass("active"),window.innerHeight<=640&&window.innerWidth<700&&$(".playlistContainer").toggleClass("hidden"),$(".searchContainer").removeClass("searchContainerFadeIn visible").addClass("searchContainerFadeOut").parent().removeClass("playerRight").addClass("playerLeft")}),$(".searchContainer").on("click",".add",function(t){e($(this).parent().data("stationId"))}),$(".searchContainer").on("click",".station",function(t){e($(this).data("stationId"))}),window.innerHeight<=640&&window.innerWidth<700){var y=$("#player").height()-($("#player .playlistsPanel").height()+$("#player .trackContainer").height());console.log(y),$(".searchContainer, .playlistContainer","#player").height(y)}var S=$("#player .playlistContainer"),C=$("#player .playlistsPanel"),b=new Audio,w={reg:!1,auth:!1},k={playlists:{},playlistsOrder:[],currentPlaylist:"",volume:.27,paused:b.paused,search:{stationsOpened:[]}},E=[],A=[],I=new(window.AudioContext||window.webkitAudioContext),O=new o("playerTag"),x=new i,L=null,T=document.getElementById("canvas-volume"),P=T.getContext("2d"),_=T.width,q=T.height;if(T.width=100,T.height=30,void 0==localStorage.getItem("userStatus")?localStorage.setItem("userStatus",JSON.stringify(w)):w=JSON.parse(localStorage.userStatus),void 0==localStorage.getItem("stations")?$.ajax({data:{action:"getAllStations"},success:function(t){E=JSON.parse(t);for(var e=E.length,a=Math.ceil(e/100),n=0;n<a;n++){A[n]=[];for(var o=0;o<100;o++){var i=100*n+o;if(n==a-1&&o==e%100)break;A[n][o]=E[i]}}localStorage.setItem("stations",JSON.stringify(E)),localStorage.setItem("stationsOn100",JSON.stringify(A))}}):(E=JSON.parse(localStorage.getItem("stations")),A=JSON.parse(localStorage.getItem("stationsOn100"))),void 0==localStorage.getItem("playerState")){new a("Default");k.currentPlaylist="Default",C.append('<div class="plName" data-name="Default">Default</div>'),S.append(k.playlists[k.currentPlaylist].htmlEl),k.playlists[k.currentPlaylist].tracks=[2599,1193,1330,55,760,884,894,900,7068,9096,4046,3187,4055,2400],k.playlists[k.currentPlaylist].currentTrack={id:1330,url:"http://graalradio.com:8123/future",title:"Graal Radio Future"},localStorage.setItem("playerState",JSON.stringify(k)),location.reload()}else{k=JSON.parse(localStorage.getItem("playerState")),console.log(k);for(var R=0;R<k.playlistsOrder.length;R++)C.append('<div class="plName" data-name="'+k.playlistsOrder[R]+'">'+k.playlistsOrder[R]+"</div>");O.setVolume(k.volume||.27),x.setVolume(k.volume||.27),$("#player .volume input").val(100*O.getVolume()),$("#player .volume input").val(100*x.getVolume()),$("#player .volume .val").html(Math.floor(100*O.getVolume())),$("#player .volume .val").html(Math.floor(100*x.getVolume())),g(),S.append(k.playlists[k.currentPlaylist].htmlEl);var M=k.playlists[k.currentPlaylist].tracks;M.length>0?($(".playlistContainer").mCustomScrollbar(),$.ajax({data:{action:"getPlaylistStations",id:M},success:function(t){for(var e=JSON.parse(t),a=S.find('.playlist[data-name="'+k.currentPlaylist+'"]'),n="",o=($(".template-track").html(),0);o<e.length;o++){var i=e[o];n+='<div class="track" data-station-id="'+i.station_id+'" data-station-title="'+i.station_title+'" data-station-url="'+i.station_url+'"><div class="delete"><i class="fa fa-minus"></i></div> \t\t\t\t\t\t\t\t\t\t<div class="canplaytest"><i class="fa fa-music"></i></div>\t\t\t\t\t\t\t\t\t\t<div class="title">'+i.station_title+'</div><div class="url">'+i.station_url+"</div></div>"}if(a.html(a.html()+n),!k.paused){var s=m().url;O.playStream(s),$('.playlistContainer .active [data-station-url="'+s+'"]').attr("data-current-track",1)}$(".playlistContainer").mCustomScrollbar("scrollTo",m().scrollPosition)}}),f()):console.log(0)}}),$(window).load(function(){}),$(document).ready(function(){function t(t){$.ajax({data:{action:"loginUniq",regLogin:t},success:function(t){if(t){$(".form-reg .regLogin").addClass("busy");var e=JSON.parse(t);$(".loginsUniq").html("");for(var a="",n=0;n<e.length;n++){a+='<div class="fieldUniq"><div class="field">'+e[n].user_login+"</div></div>"}$(".loginsUniq").html("Used :(:<br>"+a),setTimeout(function(){$(".loginsUniq").html("")},4e3)}else $(".form-reg .regLogin").hasClass("error")||($(".form-reg .regLogin").removeClass("busy"),$(".loginsUniq").html("Good choice!"),setTimeout(function(){$(".loginsUniq").html("")},4e3))}})}function e(t,e){t.fadeOut(e)}function a(t){var e;"text"==t.attr("type")?(e=/^[A-Za-zА-Яа-яЁё0-9\._-]{3,27}$/,"От 3 до 20 символов",t.position().top):"password"==t.attr("type")&&(e=/^[A-Za-zА-Яа-яЁё0-9\._-]{5,}$/,"От 5 символов",t.position().top);var a=t.val(),n=!0;return 0!=a.search(e)?(t.addClass("error"),n=!1):t.removeClass("error"),n}function n(t,e){return t.val()!=e.val()?(e.addClass("error"),!1):(e.removeClass("error"),!0)}$(".showFormSign").click(function(){$(this).toggleClass("active").siblings().toggleClass("active"),$(".form-auth").toggleClass("visible").fadeToggle(300),$(".overlayFull").toggleClass("visible").fadeToggle(300)}),$(".showFormReg").click(function(){$(this).toggleClass("active").siblings().toggleClass("active"),$(".form-reg").toggleClass("visible").fadeToggle(300),$(".overlayFull").toggleClass("visible").fadeToggle(300),$(".form-reg .regLogin").val().length>0&&t($(".form-reg .regLogin").val())}),$(".popup-overlay, .close-popup").click(function(t){e($(".popup-container, .popup-overlay"),500),$(":input",".popup-container").not(":button, :submit, :reset, :hidden").val("").removeAttr("checked").removeAttr("selected")}),$(".form-reg .regLogin").keyup(function(e){var n=$(".form-reg .regLogin");n.val().length>2&&t(n.val()),a($(this)),e.preventDefault()}),$(".form-reg .regPass").keyup(function(){a($(this))}),$(".form-reg .regPassEx").keyup(function(){n($(".form-reg .regPass"),$(this))}),$(".form-reg .regSubmit").click(function(t){var e=$(".form-reg .regLogin"),o=$(".form-reg .regPass"),i=$(".form-reg .regPassEx");return a(e)&&a(o)&&n(o,i)&&!e.hasClass("busy")&&$.ajax({data:{action:"regUser",regLogin:e.val(),regPass:o.val()},success:function(t){console.log("success"),$(".form-reg").fadeOut(300),$(".showFormReg").toggleClass("active").fadeToggle(300),$(".successReg").html("You have successfully signed up!").fadeIn(300).addClass("popupHide"),setTimeout(function(){$(".overlayFull").fadeOut(500)},4e3)}}),!1}),$(".form-auth .authSubmit").click(function(t){var e=$(".form-auth .authLogin"),n=$(".form-auth .authPass");return a(e)&&a(n)&&$.ajax({data:{action:"authUser",authLogin:e.val(),authPass:n.val()},success:function(t){if(t){console.log("data");var e=JSON.parse(t);console.log(e),$(".form-auth").fadeOut(300),$(".showFormSign").toggleClass("active").fadeToggle(300),$(".successAuth").html("Hi, "+e.user_login+"<br>Welcome to RA").fadeIn(300).addClass("popupHide"),setTimeout(function(){$(".overlayFull").fadeOut(500)},4e3)}else console.log("no data"),$(".errors").html("Login or password is not correct :("),setTimeout(function(){$(".errors").html("")},5e3)}}),!1})}),$(document).ready(function(){function t(t){$.ajax({data:{action:"checkUniqToday",cookie:t},success:function(n){n=JSON.parse(n),n.length>0?a(t):e(t)}})}function e(t){var e=navigator.userAgent,a=navigator.oscpu||navigator.platform,n=screen.width+"*"+screen.height,o=window.innerWidth+"*"+window.innerHeight;$.ajax({data:{action:"addVisit",cookie:t,useragent:e,platform:a,screensize:n,browsersize:o,timeonsite:1},success:function(t){}})}function a(t){$.ajax({data:{action:"addHit",cookie:t,timeonsite:1},success:function(t){}})}var n;void 0==localStorage.getItem("uniqHash")?(n=getHash(8),localStorage.setItem("uniqHash",n),e(n),console.log("+uniq visit first")):(n=localStorage.getItem("uniqHash"),t(n))}),$(document).ready(function(){function t(t){var e="Update SUCCES!"==t.result?"state-success":"state-warning";return'<div class="row"><div class="col-md-2">Запрос SQL</div>\t\t\t\t\t\t\t<div class="col-md-10">'+t.query+'</div></div>\t\t\t\t\t\t\t<br><br><div class="row '+e+'">\t\t\t\t\t\t\t<div class="col-md-2">Результат</div>\t\t\t\t\t\t\t<div class="col-md-10">'+t.result+"</div></div>"}$(".js-create-table").on("click",function(e){var a=$(this).attr("data-sql"),n=$($(this).attr("data-sql-value")+" option:selected").val();console.log(a),console.log(n),$.ajax({url:"actionsAdmin.php",data:{action:"makeSql",sqlAction:a,sqlValue:n},success:function(e){var a=JSON.parse(e);console.log(a);var n=$("#sqlResponse");modalBody=n.find(".modal-body"),responseMarkup=t(a),modalBody.html(responseMarkup),n.modal("toggle")}})}),$(".js-drop-table").on("click",function(e){var a=$(this).attr("data-sql"),n=$($(this).attr("data-sql-value")+" option:selected").val();console.log(a),console.log(n),$.ajax({url:"actionsAdmin.php",data:{action:"makeSql",sqlAction:a,sqlValue:n},success:function(e){var a=JSON.parse(e);console.log(a);var n=$("#sqlResponse");modalBody=n.find(".modal-body"),responseMarkup=t(a),modalBody.html(responseMarkup),n.modal("show")}})})});