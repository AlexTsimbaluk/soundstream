"use strict";function getParams(){for(var t={},a=window.location.search.substring(1).split("&"),e=0;e<a.length;e++){var s=a[e].split("=");t[s[0]]=void 0===s[1]?"":s[1]}return t}function d(t){$(".debug").html(t)}function getRandomInt(t,a){return Math.floor(Math.random()*(a-t+1))+t}function getRandomRgbColor(){return"rgb("+getRandomInt(0,255)+","+getRandomInt(0,255)+","+getRandomInt(0,255)+")"}function getHash(t){for(var a="",e=0;e<t;e++)a+=String.fromCharCode(getRandomInt(33,127));return a}var dateStart=(new Date).getTime();void 0!==getParams().admin?$("body").addClass("admin"):$("body").removeClass("admin"),$(".clearLocalStorage").on("click",function(t){return localStorage.clear(),!1}),$(".clearUniqHash").on("click",function(t){return localStorage.removeItem("stations"),!1}),$(".toAdmin").on("click",function(t){return console.log("toAdmin"),$("body").addClass("admin"),$.ajax({data:{admin:1},success:function(t){$("#player").after(t),$("#player").hide(),$(".toPlayer").on("click",function(t){return console.log("toPlayer"),$(".admin-wrapper").remove(),$("body").removeClass("admin"),$("#player").fadeIn(300),!1})}}),!1}),$.ajaxSetup({type:"POST",url:"actions.php",complete:function(){},statusCode:{200:function(t){},403:function(t){var a=JSON.parse(t.responseText);$("body").prepend(a.message)}},error:function(t,a,e,s){console.log("XHR error")}}),$(document).ready(function(){function t(){var t,a,e,s=C.playlists[C.currentPlaylist].currentTrack.title,i=s.length,n=$("#player .info .trackTitle"),l=250;n.html(s).removeClass("runningString").parent().css({width:"auto"}),a=n.width(),e=a/i,t=Math.floor(l/e)-5,a>240?window.innerWidth>700?n.addClass("runningString").parent().css({width:"240px"}):n.html(s.substr(0,t)+"..."):n.removeClass("runningString").parent().css({width:"auto"})}function a(t){$.ajax({data:{action:"getStation",id:t},success:function(t){for(var a=JSON.parse(t),e=v.find('.playlist[data-name="'+C.currentPlaylist+'"]'),s="",i=0;i<a.length;i++){var n=a[i];s+='<div class="track" data-station-id="'+n.station_id+'" data-station-title="'+n.station_title+'" data-station-url="'+n.station_url+'"><div class="delete"><i class="fa fa-minus"></i></div><div class="title">'+n.station_title+'</div><div class="url">'+n.station_url+"</div></div>",C.playlists[C.currentPlaylist].tracks.push(+n.station_id),C.playlists[C.currentPlaylist].currentTrack={id:n.station_id,url:n.station_url,title:n.station_title}}localStorage.setItem("playerState",JSON.stringify(C)),e.html(e.html()+s),e.find(".track").removeClass("selected"),e.find(".track:last").addClass("selected")}})}function e(t){this.name=t,this.tracks=[],this.currentTrack={},this.htmlEl='<div class="playlist active sortable" data-name="'+this.name+'">',C.playlists[t]=this,C.playlistsOrder.push(this.name)}function s(t,a,e){var s=this,i=t.createAnalyser();i.smoothingTimeConstant=e.smoothingTimeConstant||.7,i.fftSize=e.fftSize||512,a.connect(i),i.connect(g.destination);var n=function(){i.getByteFrequencyData(s.streamData);for(var t=0,a=0;a<80;a++)t+=s.streamData[a]};setInterval(n,20),s.streamData=new Uint8Array(i.frequencyBinCount)}function i(a){var e=document.getElementById(a),i=this,n=g.createMediaElementSource(e),l=new s(g,n,{smoothingTimeConstant:.5,fftSize:1024}),m=new s(g,n,{smoothingTimeConstant:.5,fftSize:1024}),p=new s(g,n,{smoothingTimeConstant:.5,fftSize:64}),v=new s(g,n,{smoothingTimeConstant:.5,fftSize:512});this.streamData_1=l.streamData,this.streamData_2=m.streamData,this.streamData_3=p.streamData,this.streamData_4=v.streamData,this.playStream=function(a){C.playlists[C.currentPlaylist].currentTrack={id:$(".playlistContainer .selected").data("stationId"),url:a,title:$(".playlistContainer .selected").data("stationTitle")};var s=$(".playlistContainer .active [data-station-id="+C.playlists[C.currentPlaylist].currentTrack.id+"]");console.log(s),e.src=a,e.crossOrigin="anonymous",setTimeout(function(){e.crossOrigin="anonymous"},3e3),e.addEventListener("canplay",function(t){}),e.addEventListener("error",function(t){});var n=e.play();console.log(n),$(".spinner").show(),void 0!==n&&n.then(function(){console.log("Promise::Automatic playback started!"),$(".spinner").hide(),console.log(n)}).catch(function(t){console.log(n),setTimeout(function(){console.log("Start 3s"),w.getAudio().play()},3e3)}),C.paused=e.paused,d(s),t(),i.updateTime(),localStorage.setItem("playerState",JSON.stringify(C)),setInterval(function(){i.updateTime()},1e3),console.log("AudioApiElement::playStream"),r(),o(),c()},this.stopStream=function(){u($(".playlistContainer .active [data-station-id="+C.playlists[C.currentPlaylist].currentTrack.id+"]")),$("#player .play").removeClass("visualisation"),$("#player .info .trackTitle").html("").removeClass("runningString").parent().css({width:"auto"}),e.pause(),e.currentTime=0,C.paused=e.paused,console.log("AudioApiElement::stopStream"),localStorage.setItem("playerState",JSON.stringify(C))},this.setVolume=function(t){e.volume=t},this.getVolume=function(){return e.volume},this.updateTime=function(){var t=Math.ceil(e.currentTime),a=("0"+parseInt(Math.floor(t%60))).slice(-2),s=("0"+parseInt(Math.floor(t/60)%60)).slice(-2);$("#player .time .hours").html(),$("#player .time .minutes").html(s),$("#player .time .seconds").html(a)},e.volume=C.volume}function n(){var a=new Audio,e=this;this.getAudio=function(){return a},this.playStream=function(s){C.playlists[C.currentPlaylist].currentTrack={id:$(".playlistContainer .selected").data("stationId"),url:s,title:$(".playlistContainer .selected").data("stationTitle")};var i=$(".playlistContainer .active [data-station-id="+C.playlists[C.currentPlaylist].currentTrack.id+"]");a.src=s,a.crossOrigin="anonymous",setTimeout(function(){a.crossOrigin="anonymous"},3e3);var n=a.play();$(".spinner").show(),void 0!==n&&n.then(function(){console.log("Promise::Automatic playback started!"),$(".spinner").hide()}).catch(function(t){$(".spinner").hide(),console.log("Promise::Automatic playback failed..."),console.log(t),console.log($("playlistContainer .track[data-current-track]")),e.stopStream(),$(".playlistContainer .track[data-current-track]").removeAttr("data-current-track")}),C.paused=a.paused,d(i),t(),e.updateTime(),localStorage.setItem("playerState",JSON.stringify(C)),setInterval(function(){e.updateTime()},1e3),console.log("AudioCb::playStream")},this.stopStream=function(){u($(".playlistContainer .active [data-station-id="+C.playlists[C.currentPlaylist].currentTrack.id+"]")),$("#player .play").removeClass("visualisation"),$("#player .info .trackTitle").html("").removeClass("runningString").parent().css({width:"auto"}),a.pause(),a.currentTime=0,C.paused=a.paused,console.log("AudioCbElement::stopStream"),localStorage.setItem("playerState",JSON.stringify(C))},this.setVolume=function(t){a.volume=t},this.getVolume=function(){return a.volume},this.updateTime=function(){var t=Math.ceil(a.currentTime),e=("0"+parseInt(Math.floor(t%60))).slice(-2),s=("0"+parseInt(Math.floor(t/60)%60)).slice(-2);$("#player .time .hours").html(),$("#player .time .minutes").html(s),$("#player .time .seconds").html(e)},a.volume=C.volume}function l(t,a,e){var s=document.getElementById(t);s.width=a,s.height=e,this.ctx=s.getContext("2d"),this.canvasWidth=s.width,this.canvasHeight=s.height}function r(){var t=new l("canvas-audio-source",500,510);for(t.ctx.clearRect(0,0,t.canvasWidth,t.canvasHeight),bin=0;bin<k.streamData_1.length;bin++){var a=k.streamData_1[bin];t.ctx.fillStyle="rgb("+a+","+a+","+a+")",t.ctx.fillRect(bin,t.canvasHeight/2+1,1,Math.floor(-a/1.5)),t.ctx.fillRect(bin,t.canvasHeight/2-1,1,Math.floor(a/1.5))}requestAnimationFrame(r)}function o(){var t=new l("canvas-audio-source-eq2",500,510);for(t.ctx.clearRect(0,0,t.canvasWidth,t.canvasHeight),bin=0,size=k.streamData_2.length;bin<size;bin++){var a=k.streamData_2[bin];t.ctx.fillStyle="rgb("+(255-a)+","+a+","+(255-a)+")",t.ctx.fillRect(size-bin,t.canvasHeight/2+1,1,-a/1.5),t.ctx.fillRect(size-bin,t.canvasHeight/2-1,1,a/1.5)}requestAnimationFrame(o)}function c(){var t=new l("canvas-audio-source-eq3",288,20);t.ctx.clearRect(0,0,t.canvasWidth,t.canvasHeight);for(var a=Math.floor(25.5),e=Math.floor(t.canvasWidth/32),s=Math.floor(t.canvasHeight/a),i=3,n=e+i,r=s+i,o=0;o<k.streamData_3.length;o++)for(var d=k.streamData_3[o],u=Math.floor(d/10),m=0;m<u;m++)t.ctx.strokeStyle="hsl("+(180-7*m)+", 100%, 50%)",t.ctx.strokeRect(o*n,t.canvasHeight-m*r,e,s);requestAnimationFrame(c)}function d(t){clearInterval(I),t.parent().children(".track:not(.selected)").removeClass("visualisation").removeAttr("style"),t.addClass("visualisation"),$("#player .play").addClass("visualisation"),$("#player .play span").remove(),$("#player .play.visualisation").prepend('<span class="inner"></span><span class="outer"></span>');var a=Math.floor(360*Math.random()),e=a+180,s=Math.floor(360*Math.random());window.innerWidth>700&&(I=setInterval(function(){t.css({backgroundImage:"linear-gradient(to right, hsl("+ ++a%360+", 60%, 50%) 0%, hsl("+ ++e%360+", 60%, 50%) 100%)"}),$("#player .play.visualisation").css({boxShadow:"0px 0px 5px 0.4px hsl("+ ++s%360+", 100%, 50%)",borderColor:"hsl("+ ++s%360+", 100%, 50%)"}),$("#player .play.visualisation .inner").css({borderBottomColor:"hsl("+ ++s%360+", 100%, 50%)"}),$("#player .play.visualisation .outer").css({borderTopColor:"hsl("+ ++s%360+", 100%, 50%)"})},50))}function u(t){clearInterval(I),t.removeClass("visualisation").css({backgroundImage:"none"}).removeAttr("style"),$("#player .play").removeClass("visualisation").css({boxShadow:"none",borderColor:"#0ff"}).removeAttr("style"),$("#player .play span").remove()}function m(){var t=Math.ceil(+$("#player .volume input").val()/10);A.clearRect(0,0,O,x);for(var a=36*t,e=0,s=3,i=1,n=Math.floor(O/(i+s)),l=Math.floor(n/10*t),r=x,o=r/n,c=0;c<l;c++)A.fillStyle="hsl("+c*a/l+", 100%, 50%)",A.fillRect(c*(i+s),x-c*o-o,s,c*o+o),A.fill();e+=15}function p(t){setTimeout(function(){$(".searchContainer .close").animate({top:-(t.mcs.top-10)+"px"},150)},50)}var g=new(window.AudioContext||window.webkitAudioContext);$("body").attr("data-useragent",navigator.userAgent);var v=$("#player .playlistContainer"),h=$("#player .playlistsPanel"),f=new Audio,y={reg:!1,auth:!1},C={playlists:{},playlistsOrder:[],currentPlaylist:"",volume:k?k.getVolume():0,paused:f.paused},S=[];void 0==localStorage.getItem("userStatus")?localStorage.setItem("userStatus",JSON.stringify(y)):y=JSON.parse(localStorage.userStatus),void 0==localStorage.getItem("stations")?$.ajax({data:{action:"getAllStations"},success:function(t){S=JSON.parse(t),localStorage.setItem("stations",JSON.stringify(S))}}):S=JSON.parse(localStorage.getItem("stations"));var k=new i("playerTag"),w=new n;if(void 0==localStorage.getItem("playerState")){new e("Default");C.currentPlaylist="Default",h.append('<div class="plName" data-name="Default">Default</div>'),v.append(C.playlists[C.currentPlaylist].htmlEl),C.playlists[C.currentPlaylist].currentTrack.scrollPosition=0,C.playlists[C.currentPlaylist].tracks=[2599,1193,1330,55,760,884,894,900,7068,9096,4046,3187,4055,6369,6377,6716,7942,2400],C.playlists[C.currentPlaylist].currentTrack={id:1330,url:"http://graalradio.com:8123/future",title:"Graal Radio Future"},localStorage.setItem("playerState",JSON.stringify(C))}else{C=JSON.parse(localStorage.getItem("playerState"));for(var b=0;b<C.playlistsOrder.length;b++)h.append('<div class="plName" data-name="'+C.playlistsOrder[b]+'">'+C.playlistsOrder[b]+"</div>");k.setVolume(C.volume),w.setVolume(C.volume),v.append(C.playlists[C.currentPlaylist].htmlEl);var T=C.playlists[C.currentPlaylist].tracks;T.length>0?$.ajax({data:{action:"getPlaylistStations",id:T},success:function(t){for(var a=JSON.parse(t),e=v.find('.playlist[data-name="'+C.currentPlaylist+'"]'),s="",i=($(".template-track").html(),0);i<a.length;i++){var n=a[i];s+='<div class="track" data-station-id="'+n.station_id+'" data-station-title="'+n.station_title+'" data-station-url="'+n.station_url+'"><div class="delete"><i class="fa fa-minus"></i></div><div class="title">'+n.station_title+'</div><div class="url">'+n.station_url+"</div></div>"}e.html(e.html()+s),e.find(".track[data-station-id="+C.playlists[C.currentPlaylist].currentTrack.id+"]").addClass("selected"),C.paused||k.playStream(C.playlists[C.currentPlaylist].currentTrack.url)}}):console.log(0)}var I=null;$("#player .play").click(function(t){f.paused&&k.playStream(C.playlists[C.currentPlaylist].currentTrack.url)}),$(".playlistContainer").on("click",".track",function(t){if(f.paused)if($(this).attr("data-current-track"))$(this).removeAttr("data-current-track"),k.stopStream(),w.stopStream();else{$(this).attr("data-current-track",1);var a=$(this).data("stationUrl");k.playStream(a)}}),$(".playlistContainer").on("mousedown",".track",function(t){$(this).parent().find(".selected").removeClass("selected"),$(this).addClass("selected")}),$("#player .stop").click(function(t){k.stopStream(),w.stopStream()}),$(".playlistContainer").on("click",".delete",function(t){var a=$(this).parent().data("stationId"),e=C.playlists[C.currentPlaylist];e.tracks.splice(e.tracks.indexOf(a),1),$(this).parent().remove(),localStorage.setItem("playerState",JSON.stringify(C))});var P=document.getElementById("canvas-volume"),A=P.getContext("2d");P.width=100,P.height=30;var O=P.width,x=P.height;if($("#player .volume input").val(100*k.getVolume()),$("#player .volume input").val(100*w.getVolume()),$("#player .volume .val").html(Math.floor(100*k.getVolume())),$("#player .volume .val").html(Math.floor(100*w.getVolume())),m(),$("#player .volume input").on("input",function(t){var a=$(this);k.setVolume(parseFloat($(this).val()/100)),w.setVolume(parseFloat($(this).val()/100)),C.volume=k.getVolume(),C.volume=w.getVolume(),$("#player .volume .val").html($(this).val()),0!=+a.val()?m(Math.ceil(+a.val()/10)):A.clearRect(0,0,O,x),localStorage.setItem("playerState",JSON.stringify(C))}),$("#player .volume").on("wheel",function(t){t=t||window.event;var a=$(this).find("input"),e=t.originalEvent.deltaY||t.originalEvent.detail||t.originalEvent.wheelDelta;return e>0&&+a.val()>0?a.val(+a.val()-2).trigger("input"):e<0&&+a.val()<100&&a.val(+a.val()+2).trigger("input"),!1}),$("#player .volume").on("click",function(t){return t=t||window.event,$(this).find("input").val(t.offsetX).trigger("input"),!1}),$("#player .find .showFieldSearch").click(function(t){$(this).toggleClass("active");var a=$(this).parent().find("input");0==a.hasClass("visible")?(a.addClass("visible").animate({opacity:1,width:190},100),setTimeout(function(){a.focus()},300)):a.removeClass("visible").animate({opacity:0,width:0},100).blur()}),$("#player .find input").on("keyup",function(t){var a=$(this).val();a.length>2&&($(".spinner").show(),$.ajax({data:{action:"search",target:a},success:function(t){var a=JSON.parse(t),e=$(".searchContainer .result"),s='<div class="total"><span>'+a.length+"</span> stations is found</div>";e.html("");for(var i=0;i<a.length;i++){var n=a[i];s+='<div class="station" data-station-id="'+n.station_id+'"><div class="add"><i class="fa fa-plus"></i></div><div class="title">'+n.station_title+'</div><div class="url">'+n.station_url+"</div></div>"}e.html(s),$(".spinner").hide(),$(".searchContainer").removeClass("searchContainerFadeOut").addClass("searchContainerFadeIn visible").parent().removeClass("playerLeft").addClass("playerRight"),window.innerHeight<=640&&window.innerWidth<700&&$(".playlistContainer").toggleClass("hidden")}}))}),$("#player .find .showAll").on("click",function(t){if($(this).toggleClass("active"),!$(".searchContainer .result .station").length){$(".spinner").show(),dateStart=(new Date).getTime();var a=S,e=$(".searchContainer .result"),s='<div class="total"><span>'+a.length+"</span> stations is found</div>";e.html("");for(var i=0;i<a.length;i++){var n=a[i];s+='<div class="station" data-station-id="'+n.station_id+'"><div class="add"><i class="fa fa-plus"></i></div><div class="title">'+n.station_title+'</div><div class="url">'+n.station_url+"</div></div>"}e.html(s),$(".spinner").hide();var l=(new Date).getTime();console.log(l-dateStart+"ms")}$(".spinner").show(),$(".searchContainer").hasClass("visible")?$(".searchContainer").removeClass("searchContainerFadeIn visible").addClass("searchContainerFadeOut").parent().removeClass("playerRight").addClass("playerLeft"):$(".searchContainer").removeClass("searchContainerFadeOut").addClass("searchContainerFadeIn visible").parent().removeClass("playerLeft").addClass("playerRight"),window.innerHeight<=640&&window.innerWidth<700&&$(".playlistContainer").toggleClass("hidden"),$(".spinner").hide()}),$(".searchContainer .close").on("click",function(t){$(".showAll").removeClass("active"),window.innerHeight<=640&&window.innerWidth<700&&$(".playlistContainer").toggleClass("hidden"),$(".searchContainer").removeClass("searchContainerFadeIn visible").addClass("searchContainerFadeOut").parent().removeClass("playerRight").addClass("playerLeft")}),$(".searchContainer").on("click",".add",function(t){a($(this).parent().data("stationId"))}),$(".searchContainer").on("click",".station",function(t){a($(this).data("stationId"))}),$(".sortable").sortable({scroll:!0}),$(".searchContainer").mCustomScrollbar({callbacks:{onScroll:function(){p(this)}}}),$(".playlistContainer").mCustomScrollbar({callbacks:{onScroll:function(){console.log(this.mcs.top),console.log(C.playlists[C.currentPlaylist].currentTrack),C.playlists[C.currentPlaylist].currentTrack.scrollPosition=this.mcs.top,localStorage.setItem("playerState",JSON.stringify(C))}}}),$("body").css({background:'url("../img/bg/bg'+getRandomInt(1,10)+'.jpg") no-repeat center / cover'}),$(function(){for(var t=new Array(10),a=0;a<t.length;a++){var e="/img/bg/bg"+(a+1)+".jpg";t[a]=e}$.mbBgndGallery.buildGallery({containment:"body",timer:3e3,effTimer:11e3,shuffle:!0,effect:"fade",images:t,onChange:function(t){}})}),window.innerHeight<=640&&window.innerWidth<700){var _=$("#player").height()-($("#player .playlistsPanel").height()+$("#player .trackContainer").height());console.log(_),$(".searchContainer, .playlistContainer","#player").height(_)}}),$(window).load(function(){}),$(document).ready(function(){function t(t){$.ajax({data:{action:"loginUniq",regLogin:t},success:function(t){if(t){$(".form-reg .regLogin").addClass("busy");var a=JSON.parse(t);$(".loginsUniq").html("");for(var e="",s=0;s<a.length;s++){e+='<div class="fieldUniq"><div class="field">'+a[s].user_login+"</div></div>"}$(".loginsUniq").html("Used :(:<br>"+e),setTimeout(function(){$(".loginsUniq").html("")},4e3)}else $(".form-reg .regLogin").hasClass("error")||($(".form-reg .regLogin").removeClass("busy"),$(".loginsUniq").html("Good choice!"),setTimeout(function(){$(".loginsUniq").html("")},4e3))}})}function a(t,a){t.fadeOut(a)}function e(t){var a;"text"==t.attr("type")?(a=/^[A-Za-zА-Яа-яЁё0-9\._-]{3,27}$/,"От 3 до 20 символов",t.position().top):"password"==t.attr("type")&&(a=/^[A-Za-zА-Яа-яЁё0-9\._-]{5,}$/,"От 5 символов",t.position().top);var e=t.val(),s=!0;return 0!=e.search(a)?(t.addClass("error"),s=!1):t.removeClass("error"),s}function s(t,a){return t.val()!=a.val()?(a.addClass("error"),!1):(a.removeClass("error"),!0)}$(".showFormSign").click(function(){$(this).toggleClass("active").siblings().toggleClass("active"),$(".form-auth").toggleClass("visible").fadeToggle(300),$(".overlayFull").toggleClass("visible").fadeToggle(300)}),$(".showFormReg").click(function(){$(this).toggleClass("active").siblings().toggleClass("active"),$(".form-reg").toggleClass("visible").fadeToggle(300),$(".overlayFull").toggleClass("visible").fadeToggle(300),$(".form-reg .regLogin").val().length>0&&t($(".form-reg .regLogin").val())}),$(".popup-overlay, .close-popup").click(function(t){a($(".popup-container, .popup-overlay"),500),$(":input",".popup-container").not(":button, :submit, :reset, :hidden").val("").removeAttr("checked").removeAttr("selected")}),$(".form-reg .regLogin").keyup(function(a){var s=$(".form-reg .regLogin");s.val().length>2&&t(s.val()),e($(this)),a.preventDefault()}),$(".form-reg .regPass").keyup(function(){e($(this))}),$(".form-reg .regPassEx").keyup(function(){s($(".form-reg .regPass"),$(this))}),$(".form-reg .regSubmit").click(function(t){var a=$(".form-reg .regLogin"),i=$(".form-reg .regPass"),n=$(".form-reg .regPassEx");return e(a)&&e(i)&&s(i,n)&&!a.hasClass("busy")&&$.ajax({data:{action:"regUser",regLogin:a.val(),regPass:i.val()},success:function(t){console.log("success"),$(".form-reg").fadeOut(300),$(".showFormReg").toggleClass("active").fadeToggle(300),$(".successReg").html("You have successfully signed up!").fadeIn(300).addClass("popupHide"),setTimeout(function(){$(".overlayFull").fadeOut(500)},4e3)}}),!1}),$(".form-auth .authSubmit").click(function(t){var a=$(".form-auth .authLogin"),s=$(".form-auth .authPass");return e(a)&&e(s)&&$.ajax({data:{action:"authUser",authLogin:a.val(),authPass:s.val()},success:function(t){if(t){console.log("data");var a=JSON.parse(t);console.log(a),$(".form-auth").fadeOut(300),$(".showFormSign").toggleClass("active").fadeToggle(300),$(".successAuth").html("Hi, "+a.user_login+"<br>Welcome to RA").fadeIn(300).addClass("popupHide"),setTimeout(function(){$(".overlayFull").fadeOut(500)},4e3)}else console.log("no data"),$(".errors").html("Login or password is not correct :("),setTimeout(function(){$(".errors").html("")},5e3)}}),!1})}),$(document).ready(function(){function t(t){$.ajax({data:{action:"checkUniqToday",cookie:t},success:function(s){s=JSON.parse(s),s.length>0?e(t):a(t)}})}function a(t){var a=navigator.userAgent,e=navigator.oscpu||navigator.platform,s=screen.width+"*"+screen.height,i=window.innerWidth+"*"+window.innerHeight;$.ajax({data:{action:"addVisit",cookie:t,useragent:a,platform:e,screensize:s,browsersize:i,timeonsite:1},success:function(t){}})}function e(t){$.ajax({data:{action:"addHit",cookie:t,timeonsite:1},success:function(t){}})}var s;void 0==localStorage.getItem("uniqHash")?(s=getHash(8),localStorage.setItem("uniqHash",s),a(s),console.log("+uniq visit first")):(s=localStorage.getItem("uniqHash"),t(s))}),$(document).ready(function(){function t(t){var a="Update SUCCES!"==t.result?"state-success":"state-warning";return'<div class="row"><div class="col-md-2">Запрос SQL</div>\t\t\t\t\t\t\t<div class="col-md-10">'+t.query+'</div></div>\t\t\t\t\t\t\t<br><br><div class="row '+a+'">\t\t\t\t\t\t\t<div class="col-md-2">Результат</div>\t\t\t\t\t\t\t<div class="col-md-10">'+t.result+"</div></div>"}$(".js-create-table").on("click",function(a){var e=$(this).attr("data-sql"),s=$($(this).attr("data-sql-value")+" option:selected").val();console.log(e),console.log(s),$.ajax({url:"actionsAdmin.php",data:{action:"makeSql",sqlAction:e,sqlValue:s},success:function(a){var e=JSON.parse(a);console.log(e);var s=$("#sqlResponse");modalBody=s.find(".modal-body"),responseMarkup=t(e),modalBody.html(responseMarkup),s.modal("toggle")}})}),$(".js-drop-table").on("click",function(a){var e=$(this).attr("data-sql"),s=$($(this).attr("data-sql-value")+" option:selected").val();console.log(e),console.log(s),$.ajax({url:"actionsAdmin.php",data:{action:"makeSql",sqlAction:e,sqlValue:s},success:function(a){var e=JSON.parse(a);console.log(e);var s=$("#sqlResponse");modalBody=s.find(".modal-body"),responseMarkup=t(e),modalBody.html(responseMarkup),s.modal("show")}})})}),$(window).load(function(){});