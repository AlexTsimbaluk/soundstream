var dateStart=(new Date).getTime();$(document).ready(function(){function a(a,b){h[a]=b,Cookies.set("playerState",JSON.stringify(h),{expires:180,path:"/"})}function b(a){c("POST",{action:"getStation",id:a},function(a){var b=JSON.parse(a),c=b[0],d={id:c.station_id,title:c.station_title,url:c.station_url};return d})}function c(a,b,c){$.ajax({type:a,data:b,url:"actions.php",complete:function(){},statusCode:{200:function(a){},403:function(a){var b=JSON.parse(a.responseText);$("body").prepend(b.message)}},error:function(a,b,c,d){console.log("error")},success:c})}function d(a){$("#player .info").html(a.data("stationTitle"))}function e(){var a=("0"+parseInt(g.currentTime%60)).slice(-2),b=("0"+parseInt(g.currentTime/60%60)).slice(-2);$("#player .time .hours").html(),$("#player .time .minutes").html(b),$("#player .time .seconds").html(a)}function f(a){b(+a);console.log(b(+a)),c("POST",{action:"getStation",id:a},function(a){var b=JSON.parse(a),c=$(".playlistContainer .playlist"),d="",e=b[0];d+='<div class="track" data-station-id="'+e.station_id+'" data-station-title="'+e.station_title+'" data-station-url="'+e.station_url+'"><div class="delete"><i class="fa fa-minus"></i></div><div class="title">'+e.station_title+'</div><div class="url">'+e.station_url+"</div></div>",h.playlists[0].tracks.push(+e.station_id),Cookies.set("playerState",JSON.stringify(h),{expires:180,path:"/"}),c.html(c.html()+d),c.find(".track:first").addClass("selected")})}var g=($(".playerContainer"),new Audio),h={playlists:[{active:!0,name:"Default",tracks:[],currentTrack:{}}],currentPlaylist:0,volume:g.volume,paused:g.paused};if(void 0==Cookies.get("playerState"))console.log("cookie undefined"),Cookies.set("playerState",JSON.stringify(h),{expires:180,path:"/"});else{h=JSON.parse(Cookies.get("playerState")),g.volume=h.volume,g.src=h.playlists[0].currentTrack.url,g.paused=h.paused,h.paused||g.play();var i=JSON.parse(Cookies.get("playerState")).playlists[0].tracks;c("POST",{action:"getTargetStations",id:i},function(a){for(var b=JSON.parse(a),c=$(".playlistContainer .playlist"),d="",e=0;e<b.length;e++){var f=b[e];d+='<div class="track" data-station-id="'+f.station_id+'" data-station-title="'+f.station_title+'" data-station-url="'+f.station_url+'"><div class="delete"><i class="fa fa-minus"></i></div><div class="title">'+f.station_title+'</div><div class="url">'+f.station_url+"</div></div>"}c.html(c.html()+d),c.find(".track:first").addClass("selected")})}$("#player .play").click(function(a){$(".playlist").children(".selected").length>0&&(g.src=$(".playlistContainer .selected").data("stationUrl"),g.play(),h.playlists[0].currentTrack={id:$(".playlistContainer .selected").data("stationId"),url:g.src,title:$(".playlistContainer .selected").data("stationTitle")},h.paused=g.paused,Cookies.set("playerState",JSON.stringify(h),{expires:180,path:"/"}),d($(".playlist .selected")),e(),setInterval(function(){e()},1e3))}),$("#player .stop").click(function(a){g.pause(),h.paused=g.paused,Cookies.set("playerState",JSON.stringify(h),{expires:180,path:"/"}),g.currentTime=0,$("#player .info").html("")}),$("#player .volume input").val(100*g.volume),$("#player .volume input").on("input",function(b){g.volume=parseFloat($(this).val()/100),$("#player .volume .val").html($(this).val()),a("volume",g.volume)}),$(".playlistContainer").on("mousedown",".track",function(a){console.log($(this)),$(this).parent().find(".selected").removeClass("selected"),$(this).addClass("selected")}),$(".playlistContainer").on("dblclick",".track",function(a){var b=$(this).data("stationUrl");g.src=b,g.play(),h.playlists[0].currentTrack={id:$(".playlistContainer .selected").data("stationId"),url:g.src,title:$(".playlistContainer .selected").data("stationTitle")},h.paused=g.paused,Cookies.set("playerState",JSON.stringify(h),{expires:180,path:"/"}),d($(this)),e(),setInterval(function(){e()},1e3)}),$("#player .find input").on("keyup",function(a){var b=$(this).val();b.length>2&&c("POST",{action:"find",target:b},function(a){var b=JSON.parse(a),c=$(".searchContainer .result");c.html("");for(var d='<div class="total"><span>'+b.length+"</span> stations is found</div>",e=0;e<b.length;e++){var f=b[e];d+='<div class="station" data-station-id="'+f.station_id+'"><div class="add"><i class="fa fa-plus"></i></div><div class="title">'+f.station_title+'</div><div class="url">'+f.station_url+"</div></div>"}c.html(d),$(".searchContainer").css({display:"inline-block"})})}),$(".searchContainer .close").on("click",function(a){$(this).parent().slideUp(500)}),$(".searchContainer").on("scroll",function(a){setTimeout(function(){$(".searchContainer").find(".close").animate({top:$(".searchContainer").scrollTop()+10+"px"},100)},50)}),$(".searchContainer").on("click",".add",function(a){f($(this).parent().data("stationId"))}),$(".searchContainer").on("dblclick",".station",function(a){f($(this).data("stationId"))})}),$(window).load(function(){var a=(new Date).getTime();console.log(a-dateStart+"ms")});